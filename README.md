# RestoBook

Мобильное приложение для бронирования столиков в ресторанах. Разработано на Flutter.

---

## Руководство пользователя

### Назначение приложения

**RestoBook** позволяет легко забронировать столик в ресторане прямо со смартфона. Приложение поддерживает безопасный вход через Telegram, просмотр ресторанов, управление бронированиями и отображение ресторанов на карте.

---

### Основные экраны

#### 1. Экран входа

```
┌─────────────────────────────┐
│        RestoBook            │
│   Бронирование столиков     │
│                             │
│  [Войти через Telegram]     │
└─────────────────────────────┘
```

- **Кнопка «Войти через Telegram»** — нажмите, чтобы начать вход.
  Приложение откроет Telegram-бот (@RestobkBot), который пришлёт вам одноразовый код (OTP) из 6 цифр.

#### 2. Экран ввода OTP-кода

```
┌─────────────────────────────┐
│  Введите код из Telegram    │
│                             │
│   [_] [_] [_] [_] [_] [_]  │
│                             │
│       [Подтвердить]         │
└─────────────────────────────┘
```

- Введите 6-значный код, полученный от бота в Telegram.
- Код действует **10 минут**.
- **Кнопка «Подтвердить»** — проверяет код и выполняет вход.

#### 3. Главная страница

```
┌─────────────────────────────┐
│  Привет, Иван! 👋           │
│  Выберите ресторан          │
│                             │
│  ❄️ Красноярск  -12°C Снег  │
│                             │
│  [Ресторан Дон Лучо   🖼️]  │
│  [Ресторан Los Amigos 🖼️]  │
│  [Ресторан Picante!   🖼️]  │
└─────────────────────────────┘
```

- **Приветствие** — показывает ваше имя из Telegram.
- **Карточка погоды** — отображает текущую температуру и погодные условия (данные получаются через Open-Meteo API при каждом запуске).
- **Карточки ресторанов** — нажмите на любой ресторан, чтобы перейти к его описанию.

#### 4. Детальная страница ресторана

```
┌─────────────────────────────┐
│  [Фото ресторана]           │
│                             │
│  Ресторан Дон Лучо          │
│  Описание ресторана...      │
│                             │
│  [Забронировать] [Меню]     │
│                             │
│  📞 +7 (391) 252-73-60      │
│  📍 пр. Мира, 10            │
│  🕐 10:00 – 23:00           │
│                             │
│  [🗺️ Карта с маркером]      │
└─────────────────────────────┘
```

- **Кнопка «Забронировать»** — открывает форму бронирования.
- **Кнопка «Меню»** — показывает фотографию меню ресторана.
- **Телефон** — нажмите, чтобы позвонить напрямую.
- **Адрес** — нажмите, чтобы открыть адрес в приложении Карты.
- **Встроенная карта** — показывает точное расположение ресторана на карте OpenStreetMap с зелёным маркером.

#### 5. Форма бронирования

```
┌─────────────────────────────┐
│  Новое бронирование         │
│                             │
│  Дата:  [выбрать дату]      │
│  С:     [09:00 ▾]           │
│  До:    [10:00 ▾]           │
│  Гостей: [  2  ]            │
│  Комментарий: [________]    │
│                             │
│      [Подтвердить]          │
└─────────────────────────────┘
```

- Выберите **дату**, **время начала**, **время окончания** и **количество гостей**.
- Поле **комментарий** — необязательное (пожелания к столику и т.д.).
- **Кнопка «Подтвердить»** — создаёт бронирование и сохраняет его в локальной базе данных.

#### 6. Мои бронирования

```
┌─────────────────────────────┐
│  ПРЕДСТОЯЩИЕ                │
│  ┌─────────────────────┐    │
│  │ Дон Лучо            │    │
│  │ 15 марта, 19:00     │    │
│  │ 2 гостя             │    │
│  │ [Отменить]          │    │
│  └─────────────────────┘    │
│                             │
│  ИСТОРИЯ                    │
│  ┌─────────────────────┐    │
│  │ Los Amigos          │    │
│  │ 10 марта, 13:00     │    │
│  │ Отменено       [🗑] │    │
│  └─────────────────────┘    │
└─────────────────────────────┘
```

- **ПРЕДСТОЯЩИЕ** — активные бронирования. Кнопка **«Отменить»** позволяет отменить бронирование.
- **ИСТОРИЯ** — завершённые и отменённые бронирования. Кнопка 🗑 удаляет запись из базы данных.

#### 7. Профиль

```
┌─────────────────────────────┐
│  👤 Иван Иванов             │
│  Telegram: @username        │
│                             │
│      [Выйти]                │
└─────────────────────────────┘
```

- Отображает имя и аккаунт Telegram.
- **Кнопка «Выйти»** — завершает сеанс и возвращает на экран входа.

---

## Технические сведения

### Используемые API

| API | Назначение |
|---|---|
| **Telegram Bot API** | Аутентификация через OTP-код |
| **Open-Meteo API** | Текущая погода (бесплатно, без ключа) |
| **OpenStreetMap (flutter_map)** | Встроенная карта с маркером ресторана |

### База данных

Бронирования хранятся локально в **SQLite** (пакет `sqflite`) с поддержкой полного CRUD:
- **CREATE** — создание бронирования
- **READ** — загрузка бронирований при старте
- **UPDATE** — изменение статуса бронирования
- **DELETE** — удаление записи из истории

---

## Требования для сборки

- Flutter SDK версии 3.11.0 или выше
- Android SDK (API уровень 21+)
- Подключение к интернету (для входа и данных погоды)

## Установка зависимостей

```bash
flutter pub get
```

## Запуск в режиме разработки

Подключить Android-устройство через USB с включённой отладкой USB, затем:

```bash
flutter run
```

## Сборка APK

```bash
flutter build apk --release
```

Готовый APK: `build/app/outputs/flutter-apk/app-release.apk`

**Вручную:** передать файл на устройство (через Telegram, WhatsApp и т.д.) и открыть для установки. При необходимости разрешить установку из неизвестных источников.

## Структура проекта

```
restobook/
├── lib/
│   └── main.dart          # Весь код приложения
├── assets/
│   └── images/            # Изображения ресторанов и меню
├── backend/
│   ├── bot.py             # Telegram-бот + HTTP-сервер OTP
│   ├── Dockerfile
│   └── Procfile
├── pubspec.yaml
└── README.md
```

---

## Безопасность приложения

### Аутентификация
- Вход осуществляется через **одноразовый код (OTP)**, отправляемый в Telegram. Пароли не используются и не хранятся.
- OTP-код действует **10 минут**, после чего автоматически аннулируется.
- Проверка кода выполняется на стороне сервера (Railway), а не на устройстве.

### Хранение данных
- Бронирования хранятся в **локальной базе данных SQLite** на устройстве пользователя — данные не передаются третьим лицам.
- Сессионные данные (имя, Telegram ID) сохраняются в `SharedPreferences` только на устройстве.
- Никакие платёжные или персональные данные не собираются.

### Сетевое взаимодействие
- Все запросы к серверу верификации выполняются по протоколу **HTTPS**.
- Токен Telegram-бота хранится в переменных окружения на сервере (Railway), не в исходном коде.
- Внешние API (Open-Meteo, OpenStreetMap) используются без передачи личных данных пользователя.

---

## План монетизации и публикации

### Публикация

**Платформы:**
- **Google Play Store** — основная платформа (Android). Требует единовременный взнос $25 для регистрации аккаунта разработчика.
- **Прямое распространение APK** — для пользователей вне Google Play (через сайт или мессенджеры).

**Этапы публикации в Google Play:**
1. Зарегистрировать аккаунт разработчика на [play.google.com/console](https://play.google.com/console)
2. Подписать APK release-ключом: `flutter build apk --release`
3. Загрузить APK в консоль, заполнить описание, скриншоты и политику конфиденциальности
4. Пройти проверку Google (обычно 1–3 дня)

### Монетизация

| Модель | Описание |
|---|---|
| **Freemium** | Базовые функции бесплатны. Премиум-подписка открывает приоритетное бронирование и историю без ограничений |
| **Комиссия с ресторанов** | Небольшой процент (5–10%) с каждого подтверждённого бронирования через приложение |
| **Реклама (AdMob)** | Ненавязчивые баннеры для бесплатных пользователей через Google AdMob |
| **Партнёрство с ресторанами** | Платное размещение ресторана в топе списка или выделенная карточка |

### Целевая аудитория
Пользователи смартфонов, которые регулярно посещают рестораны и ценят удобство предварительного бронирования без звонков.
